# Shadow Writing Agent - 前端开发顺序建议

## 📋 总览

基于 `FRONTEND_PLAN.md` 的详细分析，以下是推荐的开发顺序建议。这个顺序遵循"自下而上"的原则：先搭建坚实的基础架构，再逐步构建核心功能，最后添加高级特性和优化。

**总计：14个阶段，75个子任务**

## 🔴 优先级说明

- **P0（红）**：核心功能，必须优先完成
- **P1（黄）**：重要功能，尽早实现
- **P2（绿）**：辅助功能，可稍后实现
- **P3（灰）**：可选功能，根据需要

## 📅 开发顺序建议

### [ ] 阶段1：项目基础设置和依赖安装（P0）
从基础环境搭建开始，确保开发环境稳定可靠。

- [x] 阶段1.1：安装并配置 shadcn/ui 组件库
- [x] 阶段1.2：补充所有必需依赖包（sonner、clsx、tailwind-merge 等）
- [x] 阶段1.3：配置 TailwindCSS 主题和配色方案
- [x] 阶段1.4：创建完整的项目文件夹结构

### [ ] 阶段2：TypeScript 类型系统构建（P0）
类型系统是前端架构的基石，必须优先完善。

- [x] 阶段2.1：实现完整的类型定义文件（types/ 目录）
- [x] 阶段2.2：定义所有业务模型类型（TED、Task、ShadowWriting 等）
- [x] 阶段2.3：定义 API 请求/响应接口类型
- [x] 阶段2.4：定义 WebSocket 消息类型

### [ ] 阶段3：基础服务层搭建（P0）
服务层是前端与后端的桥梁，需要早起搭建。

- [x] 阶段3.1：实现 API Service（services/api.ts）
- [x] 阶段3.2：实现 WebSocket Service（services/websocket.ts）
- [x] 阶段3.3：实现数据转换工具函数
- [x] 阶段3.4：实现 LocalStorage 存储工具

### [ ] 阶段4：错误处理和基础组件（P0）
错误处理贯穿整个应用，必须早起实现。

- [ ] 阶段4.1：实现 ErrorBoundary 组件
- [ ] 阶段4.2：实现异步错误处理 Hook（useAsyncError）
- [ ] 阶段4.3：实现统一的错误处理体系

### [ ] 阶段5：整体架构设计（Layout + 页面）（P0）
架构设计完成后，应用骨架清晰可见。

- [ ] 阶段5.1：实现 React Router 路由配置
- [ ] 阶段5.2：创建所有页面组件骨架
- [ ] 阶段5.3：实现 Layout 组件（侧边栏 + 内容区）
- [ ] 阶段5.4：实现 Sidebar 导航组件
- [ ] 阶段5.5：实现 TaskContext 全局状态管理

### [ ] 阶段6：对话式搜索功能（SearchPage）（P0）
核心功能之一，用户最先使用的功能。

- [ ] 阶段6.1：实现 ChatInterface 容器组件
- [ ] 阶段6.2：实现 MessageBubble 消息气泡
- [ ] 阶段6.3：实现 ChatInput 输入框组件
- [ ] 阶段6.4：实现 QuickSuggestions 快速建议
- [ ] 阶段6.5：实现 RecentSearches 最近搜索
- [ ] 阶段6.6：实现 TEDCard 卡片组件
- [ ] 阶段6.7：实现 TEDList 列表容器
- [ ] 阶段6.8：实现批量操作栏 BatchActionBar

### [ ] 阶段7：批量处理进度页面（BatchProcessPage）（P0）
核心功能之二，展示处理进度。

- [ ] 阶段7.1：实现 ProgressOverview 总体进度组件
- [ ] 阶段7.2：实现 TaskItem 单个任务项
- [ ] 阶段7.3：实现 TaskList 任务列表
- [ ] 阶段7.4：实现 LiveLogPanel 实时日志面板
- [ ] 阶段7.5：实现 WebSocketStatus 连接状态指示器

### [ ] 阶段8：结果展示页面（ResultsPage）（P0）
核心功能之三，展示学习成果。

- [ ] 阶段8.1：实现 CardNavigator 翻页容器（shadcn Carousel）
- [ ] 阶段8.2：实现 ShadowWritingCard 核心卡片组件
- [ ] 阶段8.3：实现 NavigationButtons 导航按钮
- [ ] 阶段8.4：实现 ProgressDots 进度点指示器
- [ ] 阶段8.5：实现 ResultHeader 头部信息
- [ ] 阶段8.6：实现 ActionBar 操作栏

### [ ] 阶段9：历史记录页面（HistoryPage）（P1）
重要功能，帮助用户回顾学习历史。

- [ ] 阶段9.1：实现 StatsSummary 统计摘要
- [ ] 阶段9.2：实现 HistoryItem 历史记录项
- [ ] 阶段9.3：实现 SearchHistoryPanel 搜索历史面板
- [ ] 阶段9.4：集成学习时长和连续打卡计算

### [ ] 阶段10：设置页面（SettingsPage）（P1）
应用配置页面，提供个性化选项。

- [ ] 阶段10.1：实现 API 配置表单
- [ ] 阶段10.2：实现外观设置（主题、字体大小）
- [ ] 阶段10.3：实现学习偏好设置
- [ ] 阶段10.4：实现数据管理功能（清空历史）

### [ ] 阶段11：性能优化和高级功能（P1）
提升用户体验，优化性能。

- [ ] 阶段11.1：实现代码分割（路由级别懒加载）
- [ ] 阶段11.2：实现组件记忆化（React.memo、useMemo、useCallback）
- [ ] 阶段11.3：实现防抖和节流（搜索输入、窗口resize）
- [ ] 阶段11.4：实现图片懒加载
- [ ] 阶段11.5：添加键盘导航和无障碍支持

### [ ] 阶段12：Electron 桌面应用集成（P2）
转换为桌面应用，扩展使用场景。

- [ ] 阶段12.1：配置主进程（electron/main.js）
- [ ] 阶段12.2：配置预加载脚本（electron/preload.js）
- [ ] 阶段12.3：配置 Electron Builder
- [ ] 阶段12.4：实现最小窗口适配（1024px）

### [ ] 阶段13：测试配置和质量保证（P2）
确保代码质量，减少bug。

- [ ] 阶段13.1：配置 Vitest 测试框架
- [ ] 阶段13.2：编写核心组件测试
- [ ] 阶段13.3：编写 API Service 测试
- [ ] 阶段13.4：编写 WebSocket Service 测试

### [ ] 阶段14：部署和性能监控（P3）
生产环境部署和监控（可选）。

- [ ] 阶段14.1：配置 Vite 构建优化
- [ ] 阶段14.2：集成 Sentry 错误追踪
- [ ] 阶段14.3：集成 Web Vitals 性能监控
- [ ] 阶段14.4：配置 PWA 支持（可选）

## 📊 开发时间估算

| 阶段 | 任务数 | 预估时间 | 说明 |
|------|--------|----------|------|
| 阶段1-5 | 25 | 5-7天 | 基础架构搭建 |
| 阶段6-8 | 21 | 10-14天 | 核心功能开发 |
| 阶段9-11 | 15 | 7-10天 | 重要功能和优化 |
| 阶段12-14 | 14 | 5-7天 | 桌面应用和测试 |

**总预估时间：27-38天**（根据个人经验，实际可能因熟练度而异）

## 🎯 为什么这个顺序？

### 1. **自下而上，层层依赖**
- 先搭好基础（类型、服务），再建高层（组件、页面）
- 避免"边建边改"的低效循环

### 2. **核心功能优先**
- P0阶段覆盖应用的核心价值：搜索 → 处理 → 结果展示
- 确保MVP版本快速可用

### 3. **风险控制**
- 早起实现错误处理，避免后期大改
- 早起搭建类型系统，避免类型错误泛滥

### 4. **渐进增强**
- 先实现基础功能，再添加高级特性
- 每个阶段都可以独立测试和验证

## ⚠️ 重要提醒

### 依赖项确认
- 后端API必须先启动（`http://localhost:8000`）
- 环境变量配置（`.env.local`）
- Node.js版本兼容性检查

### 技术难点预备
- **WebSocket实时通信**：需要理解后端消息格式
- **批量结果扁平化**：`flattenBatchResults()`是关键函数
- **彩色高亮映射**：`convertMapToHighlightMapping()`算法
- **Electron适配**：最小窗口1024px布局调整

### 测试策略
- 每个阶段完成后，进行集成测试
- 重点测试数据转换函数的正确性
- 验证前后端接口对齐

## 🚀 开始开发建议

1. **先从阶段1开始**：确保基础环境完整
2. **阶段1-5完成后**：可以运行基本应用骨架
3. **阶段6-8完成后**：核心功能完整，可演示
4. **剩余阶段**：按需添加，根据时间和需求

**建议第一周完成阶段1-5，建立完整开发环境和基础架构。**

---

*最后更新：2025-10-12*  
*基于 FRONTEND_PLAN.md 制定*