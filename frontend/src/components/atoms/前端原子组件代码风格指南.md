# 前端原子组件代码风格指南

## 概述
本文档定义了前端项目中原子组件（atoms）的统一代码风格标准，确保所有组件代码风格一致，提高代码可读性和可维护性。

## 1. 基础原则
- **一致性优先**：所有原子组件必须遵循统一的风格
- **TypeScript 优先**：所有组件使用 TypeScript 编写
- **React 最佳实践**：遵循 React 官方推荐的编码模式
- **组件命名**：使用 PascalCase（大驼峰命名法）
- **函数组件优先**：推荐使用函数组件而不是类组件
- **Props 解构**：在函数组件中直接解构 props，提高可读性

## 2. 文件结构
```
frontend/src/components/atoms/
├── component-name.tsx    # 单个组件文件
```

## 3. 导入语句规范

### 3.1 React 导入
**必须**：
```typescript
import * as React from "react"
```

**禁止**：
```typescript
// ❌ 不一致的导入方式
import { forwardRef } from 'react'
import React, { forwardRef } from 'react'
```

### 3.2 其他导入
- 工具库统一使用别名路径：`@/lib/utils`
- 第三方库按字母顺序排列
- 内部导入放在外部导入之后

**示例**：
```typescript
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
```

## 4. 组件定义规范

### 4.1 组件类型
- **必须**使用 `React.forwardRef` 定义需要 ref 的组件
- **必须**设置 `displayName` 属性
- **必须**使用 PascalCase 命名

### 4.2 Props 类型定义
- **必须**使用完整的 TypeScript 类型注解
- **必须**继承 React 内置类型
- **推荐**使用 `VariantProps<typeof variants>` 定义变体类型

**示例**：
```typescript
export interface ComponentProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof componentVariants> {}

const Component = React.forwardRef<HTMLDivElement, ComponentProps>(
  ({ className, variant, ...props }, ref) => {
    // 组件实现
  }
)
Component.displayName = "Component"
```

## 5. 变体定义（Variants）

### 5.1 使用 class-variance-authority
- **必须**使用 `cva` 定义变体
- **必须**提供 `defaultVariants`
- **推荐**使用语义化的变体名称

**示例**：
```typescript
const componentVariants = cva(
  "base-classes",
  {
    variants: {
      variant: {
        default: "default-classes",
        secondary: "secondary-classes",
      },
      size: {
        default: "default-size-classes",
        sm: "small-classes",
        lg: "large-classes",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)
```

## 6. 类名处理

### 6.1 cn 函数使用
- **必须**使用 `cn` 函数合并类名
- **必须**将组件类名放在第一位，自定义类名通过 `className` prop 传递

**示例**：
```typescript
<div className={cn(componentVariants({ variant, size }), className)} />
```

## 7. 导出规范

### 7.1 导出方式
- **必须**使用命名导出
- **必须**同时导出组件和其变体（如果有）

**示例**：
```typescript
export { Component, componentVariants }
```

## 8. 代码格式规范

### 8.1 缩进和换行
- 使用 2 个空格缩进
- JSX 代码使用 2 个空格缩进，保持一致性
- 适当添加空行分隔逻辑块
- 长行适当换行

### 8.2 注释规范
- 使用英文注释（除非有特殊需求）
- 注释应说明为什么这么做，而不是做什么
- 对于重要的设计变更，应添加注释说明

**示例**：
```typescript
// 使用设计系统尺寸替代硬编码值
componentSizes.input.md.height
```

## 9. 特殊组件处理

### 9.1 无状态函数组件
对于不需要 ref 的简单组件，可以使用函数声明，但仍然需要遵循其他规范。

### 9.2 复合组件
对于包含多个子组件的复合组件（如 Card），应在同一文件中定义所有相关组件。

## 10. 质量保证

### 10.1 代码检查
- 组件必须通过 TypeScript 类型检查
- 必须遵循 ESLint 规则
- 组件必须有适当的 displayName

### 10.2 文档要求
- 复杂组件应有 JSDoc 注释
- Props 应有清晰的类型定义
- 变体应有明确的用途说明

## 11. 迁移指南

### 11.1 现有组件统一
1. 检查现有组件是否符合标准
2. 逐步修改不符合标准的组件
3. 添加必要的注释说明变更
4. 验证修改后功能正常

### 11.2 新组件开发
所有新开发的原子组件必须严格遵循本指南。

## 12. 例外情况
在特殊情况下可以偏离本指南，但必须：
- 在代码中添加注释说明原因
- 经过团队讨论同意
- 记录在项目文档中

## 13. 实际案例

以下是一个遵循代码风格指南的 React 组件示例：

```typescript
import * as React from "react"
import { cn } from "@/lib/utils"

export interface UserCardProps extends React.HTMLAttributes<HTMLDivElement> {
  name: string
  age: number
  email: string
}

const UserCard = React.forwardRef<HTMLDivElement, UserCardProps>(
  ({ className, name, age, email, ...props }, ref) => {
    return (
      <div
        ref={ref}
        className={cn("user-card p-4 border rounded-lg", className)}
        {...props}
      >
        <h2 className="text-xl font-semibold">{name}</h2>
        <p>Age: {age}</p>
        <p>Email: {email}</p>
      </div>
    )
  }
)
UserCard.displayName = "UserCard"

export { UserCard }
```

## 14. 总结
遵循一致的代码风格是 React 开发中的最佳实践之一。通过使用清晰的命名、函数组件、解构 props、TypeScript 类型检查和统一的导出方式，你可以编写出更易于理解和维护的代码。记住，良好的代码风格不仅是为了你自己，也是为了团队中的其他开发者。

---

**最后更新时间**：2025年10月30日
**版本**：1.1
**适用范围**：frontend/src/components/atoms/*